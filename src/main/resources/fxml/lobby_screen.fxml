<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import java.net.URL?>
<BorderPane xmlns="http://javafx.com/javafx/17"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="ch.unibas.dmi.dbis.cs108.client.ui.controllers.LobbyScreenController"
            prefHeight="600.0" prefWidth="800.0">

    <top>
        <HBox alignment="CENTER" spacing="10.0" styleClass="header-panel">
            <padding>
                <Insets top="15.0" right="20.0" bottom="15.0" left="20.0"/>
            </padding>
            <Label text="Game Lobby" styleClass="screen-title"/>
            <Region HBox.hgrow="ALWAYS"/>
            <Label fx:id="playerNameLabel" text="Player: Guest"/>
        </HBox>
    </top>

    <center>
        <SplitPane dividerPositions="0.6">
            <VBox spacing="10.0" styleClass="lobby-panel">
                <padding>
                    <Insets top="10.0" right="10.0" bottom="10.0" left="10.0"/>
                </padding>

                <Label text="Available Games" styleClass="section-header"/>
                <HBox spacing="10.0">
                    <TextField fx:id="searchField" promptText="Search..." HBox.hgrow="ALWAYS"/>
                    <Button text="Refresh" onAction="#handleRefreshLobbies"/>
                </HBox>
                <TableView fx:id="lobbyTable" VBox.vgrow="ALWAYS">
                    <columns>
                        <TableColumn fx:id="nameColumn" text="Lobby Name" prefWidth="150.0"/>
                        <TableColumn fx:id="playersColumn" text="Players" prefWidth="80.0"/>
                        <TableColumn fx:id="statusColumn" text="Status" prefWidth="100.0"/>
                        <TableColumn fx:id="hostColumn" text="Host" prefWidth="120.0"/>
                    </columns>
                </TableView>

                <HBox spacing="10.0">
                    <TextField fx:id="lobbyNameField" promptText="New Lobby Name" HBox.hgrow="ALWAYS"/>
                    <Button text="Create Lobby" onAction="#handleCreateLobby" styleClass="action-button"/>
                </HBox>
                <Button text="Join Selected Lobby" onAction="#handleJoinLobby" maxWidth="Infinity"/>
                <Label fx:id="errorMessage" textFill="red" wrapText="true"/>
            </VBox>

            <VBox spacing="10.0" styleClass="players-panel">
                <padding>
                    <Insets top="10.0" right="10.0" bottom="10.0" left="10.0"/>
                </padding>

                <Label text="Lobby Chat" styleClass="section-header"/>
                <ListView fx:id="chatMessages" VBox.vgrow="ALWAYS"/>
                <HBox spacing="5.0">
                    <TextField fx:id="chatInput" promptText="Type a message..." HBox.hgrow="ALWAYS"/>
                    <Button text="Send" onAction="#handleSendChatMessage"/>
                </HBox>

                <Label text="Players" styleClass="section-header"/>
                <ListView fx:id="playerList" prefHeight="150.0"/>

                <Region VBox.vgrow="ALWAYS"/>

                <VBox fx:id="hostControlsPanel" spacing="5.0" visible="false" managed="false">
                    <Label text="Host Controls" styleClass="section-header"/>
                    <HBox spacing="5.0">
                        <Label text="Max Players:"/>
                        <ComboBox fx:id="maxPlayersCombo" promptText="4"/>
                    </HBox>
                    <Button text="Start Game" onAction="#handleStartGame" styleClass="primary-button"
                            maxWidth="Infinity"/>
                </VBox>
            </VBox>
        </SplitPane>
    </center>

    <bottom>
        <HBox alignment="CENTER_RIGHT" spacing="10.0" styleClass="footer-panel">
            <padding>
                <Insets top="10.0" right="10.0" bottom="10.0" left="10.0"/>
            </padding>
            <Button text="Back to Main Menu" onAction="#handleBackToMainMenu"/>
        </HBox>
    </bottom>

    <stylesheets>
        <URL value="@/css/lobby-screen.css"/>
    </stylesheets>
</BorderPane>