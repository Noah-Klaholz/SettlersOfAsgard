<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.canvas.Canvas?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<BorderPane xmlns="http://javafx.com/javafx/16" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="ch.unibas.dmi.dbis.cs108.client.ui.controllers.GameScreenController"
            stylesheets="/css/game-screen.css"
            minWidth="900" minHeight="600" prefWidth="1200" prefHeight="768" maxWidth="1920" maxHeight="1080">

    <top>
        <HBox alignment="CENTER" spacing="15.0" styleClass="header-panel">
            <padding>
                <Insets top="15.0" right="20.0" bottom="15.0" left="20.0"/>
            </padding>
            <!-- Left side -->
            <Label text="Settlers of Asgard" styleClass="screen-title"/>

            <!-- Flexible space -->
            <Region HBox.hgrow="ALWAYS"/>

            <!-- Middle - Settings button -->
            <Button text="Settings" onAction="#handleSettings" styleClass="action-button"/>

            <!-- Flexible space -->
            <Region HBox.hgrow="ALWAYS"/>

            <!-- Right side - Connection status -->
            <Label fx:id="connectionStatusLabel" text="Connected" styleClass="status-label"/>
        </HBox>
    </top>

    <left>
        <VBox spacing="10" styleClass="side-panel" prefWidth="220.0" minWidth="180.0">
            <padding>
                <Insets top="20.0" right="15.0" bottom="20.0" left="15.0"/>
            </padding>

            <Label text="Resources" styleClass="section-title"/>
            <VBox spacing="8" styleClass="resource-section">
                <HBox spacing="10" alignment="CENTER_LEFT">
                    <Label text="Energy:" minWidth="60"/>
                    <ProgressBar fx:id="energyBar" styleClass="energy-bar" progress="0.5" HBox.hgrow="ALWAYS"/>
                </HBox>
                <HBox spacing="10" alignment="CENTER_LEFT">
                    <Label text="Runes:" minWidth="60"/>
                    <Label fx:id="runesLabel" text="5" styleClass="resource-value"/>
                </HBox>
            </VBox>

            <Separator/>

            <Label text="Players" styleClass="section-title"/>
            <ListView fx:id="playersList" VBox.vgrow="ALWAYS" styleClass="players-list" minHeight="150"/>

            <VBox spacing="8" VBox.vgrow="NEVER">
                <Button text="Resource Overview" onAction="#handleResourceOverview" styleClass="action-button"
                        maxWidth="Infinity"/>
                <Button text="Leaderboard" onAction="#handleLeaderboard" styleClass="action-button"
                        maxWidth="Infinity"/>
                <Button text="End Turn" onAction="#handleGameRound" styleClass="action-button" maxWidth="Infinity"/>
            </VBox>
        </VBox>
    </left>

    <center>
        <StackPane styleClass="game-board-container">
            <Canvas fx:id="gameCanvas" width="600" height="400"/>
        </StackPane>
    </center>

    <bottom>
        <VBox spacing="5">
            <TitledPane text="Cards" collapsible="true">
                <HBox spacing="10" styleClass="card-section">
                    <VBox spacing="5">
                        <Label text="Artifacts:" styleClass="card-category"/>
                        <HBox fx:id="artifactHand" spacing="8">
                            <Pane fx:id="artifact1" styleClass="card,artifact-card" prefWidth="80" prefHeight="120"/>
                            <Pane fx:id="artifact2" styleClass="card,artifact-card" prefWidth="80" prefHeight="120"/>
                            <Pane fx:id="artifact3" styleClass="card,artifact-card" prefWidth="80" prefHeight="120"/>
                        </HBox>
                    </VBox>

                    <Separator orientation="VERTICAL" styleClass="section-divider"/>

                    <VBox spacing="5" HBox.hgrow="ALWAYS">
                        <Label text="Structures:" styleClass="card-category"/>
                        <FlowPane fx:id="structureHand" hgap="8" vgap="8">
                            <Pane fx:id="structure1" styleClass="card,structure-card" prefWidth="80" prefHeight="120"/>
                            <Pane fx:id="structure2" styleClass="card,structure-card" prefWidth="80" prefHeight="120"/>
                            <Pane fx:id="structure3" styleClass="card,structure-card" prefWidth="80" prefHeight="120"/>
                            <Pane fx:id="structure4" styleClass="card,structure-card" prefWidth="80" prefHeight="120"/>
                            <Pane fx:id="structure5" styleClass="card,structure-card" prefWidth="80" prefHeight="120"/>
                            <Pane fx:id="structure6" styleClass="card,structure-card" prefWidth="80" prefHeight="120"/>
                            <Pane fx:id="structure7" styleClass="card,structure-card" prefWidth="80" prefHeight="120"/>
                            <Pane fx:id="structure8" styleClass="card,structure-card" prefWidth="80" prefHeight="120"/>
                        </FlowPane>
                    </VBox>
                </HBox>
            </TitledPane>
        </VBox>
    </bottom>

    <right>
        <VBox spacing="10" styleClass="chat-panel" prefWidth="280.0" minWidth="250.0">
            <padding>
                <Insets top="15.0" right="15.0" bottom="15.0" left="15.0"/>
            </padding>

            <HBox spacing="5" styleClass="chat-selector">
                <ToggleButton fx:id="globalChatButton" text="Global"
                              onAction="#handleGlobalChatSelect" styleClass="chat-toggle-button" minWidth="70"/>
                <ToggleButton fx:id="lobbyChatButton" text="Lobby"
                              onAction="#handleLobbyChatSelect" styleClass="chat-toggle-button" minWidth="70"/>
                <Region HBox.hgrow="ALWAYS"/>
            </HBox>

            <ListView fx:id="chatListView" VBox.vgrow="ALWAYS" styleClass="chat-list" minHeight="200"/>

            <HBox spacing="8.0" alignment="CENTER">
                <TextField fx:id="chatInputField" promptText="Type a message..."
                           HBox.hgrow="ALWAYS" onAction="#handleMessageSend"/>
                <Button text="Send" onAction="#handleMessageSend"
                        styleClass="send-button"/>
            </HBox>
        </VBox>
    </right>
</BorderPane>